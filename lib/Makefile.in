all: libconverge.cvl

OBJECT_FILES = File.cvb Functional.cvb Parse_Options.cvb Maths.cvb Numbers.cvb Sort.cvb Strings.cvb \
	CPK/Tokens.cvb CPK/init.cvb CPK/Token.cvb CPK/Earley/init.cvb \
	CPK/Earley/Grammar.cvb CPK/Earley/Parser.cvb CPK/Traverser.cvb CPK/Tree.cvb \
	Platform/Properties.cvb Platform/Env.cvb XML/Nodes.cvb XML/XDM.cvb

include @abs_top_srcdir@/Makefile.inc

CONVERGEC_FLAGS += --bootstrap

ifdef TARGET
CROSS_OBJECTS = ${OBJECT_FILES:.cvb=.${TARGET}.cvb}

cross: ${CROSS_OBJECTS}
	${CONVERGE_VM} ${CONVERGEL} -l -T ${TARGET} -o libconverge.${TARGET}.cvl ${CROSS_OBJECTS}

cross-clean:
	rm -f ${CROSS_OBJECTS} libconverge.${TARGET}.cvl
endif


libconverge.cvl: ${OBJECT_FILES}
	${CONVERGE_VM} ${CONVERGEL} -l -o libconverge.cvl ${OBJECT_FILES}

clean:
	rm -f ${OBJECT_FILES} libconverge.cvl

distclean: clean
	rm -f Makefile .depend
