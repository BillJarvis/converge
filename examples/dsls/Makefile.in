include @abs_top_srcdir@/Makefile.inc

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
datarootdir = @datarootdir@
datadir = @datadir@
conexamplesdir = ${datadir}/examples/converge-@CONVERGE_VERSION@
INSTALL = @INSTALL@


%.cvb: %.cv
	${CONVERGE_VM} ${CONVERGEC} -o $@ $<


all: switch
	cd statemachine && ${MAKE} ${MFLAGS}

install: all
	cd statemachine && ${MAKE} ${MFLAGS} install
	${INSTALL} -d ${DESTDIR}${conexamplesdir}/dsls
	${INSTALL} -c -m 444 switch.cv ${DESTDIR}${conexamplesdir}/dsls

switch: switch.cvb
	${CONVERGE_VM} ${CONVERGEL} -o switch switch.cvb

clean:
	cd statemachine && ${MAKE} ${MFLAGS} clean
	rm -f switch switch.cvb

distclean: clean
	cd statemachine && ${MAKE} ${MFLAGS} distclean
	rm -f Makefile
